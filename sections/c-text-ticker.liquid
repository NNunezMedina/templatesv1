<style>
  #c-text-ticker-{{ section.id }} {
    background-color: {{ section.settings.bg_color }};
    color: {{ section.settings.text_color }};
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.5rem 1rem;
    overflow: hidden;
    position: relative;
    font-family: inherit;
  }

  #c-text-ticker-{{ section.id }} .ticker-toggle {
  background: none;
  color: {{ section.settings.toggle_icon_color }};
  border: none;
  font-size: 16px;
  cursor: pointer;
  padding: 0;
  width: auto;
  height: auto;
  display: flex;
  align-items: center;
  justify-content: center;
    }

  #c-text-ticker-{{ section.id }} .ticker-text-container {
    flex-grow: 1;
    overflow: hidden;
    white-space: nowrap;
    position: relative;
  }

  #c-text-ticker-{{ section.id }} .ticker-slide {
    display: none;
    align-items: center;
    justify-content: flex-start;
    gap: 2px;
    animation: fadeIn 0.5s ease-in-out;
  }

  #c-text-ticker-{{ section.id }} .ticker-slide.active {
    display: flex;
  }

  #c-text-ticker-{{ section.id }} .ticker-button {
    background-color: {{ section.settings.button_bg_color }};
    color: {{ section.settings.button_text_color }};
    text-decoration: underline;
    font-size: {{ section.settings.button_font_size_desktop }}rem;
    border-radius: 4px;
    border: none;
    white-space: nowrap;
    transition: background-color 0.3s ease;
  }

  #c-text-ticker-{{ section.id }} .ticker-button:hover {
    text-decoration:underline;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
  }

  #c-text-ticker-{{ section.id }} .ticker-text {
  font-size: {{ section.settings.text_font_size_desktop }}rem;
}

@media screen and (max-width: 767px) {
  #c-text-ticker-{{ section.id }} .ticker-text {
    font-size: {{ section.settings.text_font_size_mobile }}rem;
  }

  #c-text-ticker-{{ section.id }} .ticker-button {
    font-size: {{ section.settings.button_font_size_mobile }}rem;
  }
}
</style>

<section id="c-text-ticker-{{ section.id }}">
  <button class="ticker-toggle" aria-label="Alternar animación">
    &#10074;&#10074; <!-- Pause por defecto -->
  </button>

  <div class="ticker-text-container">
    {% for block in section.blocks %}
      <div class="ticker-slide {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}">
        <span class="ticker-text">{{ block.settings.text }}</span>
        {% if block.settings.button_label != blank %}
        <a href="{{ block.settings.button_url }}" class="ticker-button">{{ block.settings.button_label }}</a>
        {% endif %}
      </div>
    {% endfor %}
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const section = document.querySelector('#c-text-ticker-{{ section.id }}');
      const slides = section.querySelectorAll('.ticker-slide');
      const toggleBtn = section.querySelector('.ticker-toggle');

      let current = 0;
      let playing = true;
      let interval = setInterval(showNext, 3000);

      function showNext() {
        slides[current].classList.remove('active');
        current = (current + 1) % slides.length;
        slides[current].classList.add('active');
      }

      toggleBtn.addEventListener('click', function () {
        if (playing) {
          clearInterval(interval);
          toggleBtn.innerHTML = '&#9658;'; // ▶
        } else {
          interval = setInterval(showNext, 3000);
          toggleBtn.innerHTML = '&#10074;&#10074;'; // ‖
        }
        playing = !playing;
      });
    });
  </script>
</section>

{% schema %}
{
  "name": "C Text Ticker",
  "settings": [
    {
      "type": "color",
      "id": "bg_color",
      "label": "Color de fondo",
      "default": "#f8f8f8"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Color del texto",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "toggle_icon_color",
      "label": "Color del ícono Play/Pausa",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Color de fondo del botón de texto",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Color del texto del botón de texto",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_bg_color",
      "label": "Color de fondo del botón (hover)",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_text_color",
      "label": "Color del texto del botón (hover)",
      "default": "#000000"
    },
    {
    "type": "header",
    "content": "Tamaños de fuente"
    },
    {
    "type": "range",
    "id": "text_font_size_desktop",
    "label": "Tamaño de texto (Desktop)",
    "min": 0.5,
    "max": 3,
    "step": 0.1,
    "unit": "rem",
    "default": 1.2
    },
    {
    "type": "range",
    "id": "text_font_size_mobile",
    "label": "Tamaño de texto (Mobile)",
    "min": 0.5,
    "max": 3,
    "step": 0.1,
    "unit": "rem",
    "default": 1
    },
    {
    "type": "range",
    "id": "button_font_size_desktop",
    "label": "Tamaño del botón (Desktop)",
    "min": 0.5,
    "max": 3,
    "step": 0.1,
    "unit": "rem",
    "default": 1
    },
    {
    "type": "range",
    "id": "button_font_size_mobile",
    "label": "Tamaño del botón (Mobile)",
    "min": 0.5,
    "max": 3,
    "step": 0.1,
    "unit": "rem",
    "default": 0.9
    }
  ],
  "blocks": [
    {
      "type": "text_block",
      "name": "Texto deslizante",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Texto",
          "default": "Texto destacado de ejemplo"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Texto del botón (opcional)"
        },
        {
          "type": "url",
          "id": "button_url",
          "label": "Enlace del botón"
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "C Text Ticker",
      "blocks": [
        {
          "type": "text_block"
        },
        {
          "type": "text_block"
        }
      ]
    }
  ]
}
{% endschema %}
